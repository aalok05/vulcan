
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulcan Security Report</title>
    <style>
            :root {
                --bg-primary: #0f172a;
                --bg-secondary: #1e293b;
                --text-primary: #f8fafc;
                --text-secondary: #94a3b8;
                --accent: #38bdf8;
                --danger: #ef4444;
                --warning: #f59e0b;
                --success: #22c55e;
                --border: #334155;
            }
            body {
                font-family: 'Inter', system-ui, -apple-system, sans-serif;
                background-color: var(--bg-primary);
                color: var(--text-primary);
                line-height: 1.6;
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 1000px;
                margin: 0 auto;
                padding: 2rem;
            }
            header {
                border-bottom: 1px solid var(--border);
                padding-bottom: 2rem;
                margin-bottom: 2rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            h1 { font-size: 2rem; font-weight: 700; margin: 0; color: var(--accent); }
            h2 { font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
            .meta { color: var(--text-secondary); font-size: 0.9rem; }
            
            .card {
                background-color: var(--bg-secondary);
                border: 1px solid var(--border);
                border-radius: 0.75rem;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }
            .stat-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 2rem;
            }
            .stat-card h3 { margin: 0; font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
            .stat-card p { margin: 0.5rem 0 0; font-size: 2rem; font-weight: 700; }
            
            .vuln-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 1rem;
            }
            .vuln-title { font-weight: 600; font-size: 1.1rem; }
            .badge {
                padding: 0.25rem 0.75rem;
                border-radius: 9999px;
                font-size: 0.75rem;
                font-weight: 600;
                text-transform: uppercase;
            }
            .badge-HIGH { background-color: rgba(239, 68, 68, 0.2); color: var(--danger); }
            .badge-MEDIUM { background-color: rgba(245, 158, 11, 0.2); color: var(--warning); }
            .badge-FIXED { background-color: rgba(34, 197, 94, 0.2); color: var(--success); }
            .badge-OPEN { background-color: rgba(148, 163, 184, 0.2); color: var(--text-secondary); }
            
            code {
                background-color: rgba(0,0,0,0.3);
                padding: 0.2rem 0.4rem;
                border-radius: 0.25rem;
                font-family: monospace;
                font-size: 0.9em;
            }
            .summary-text { font-size: 1.1rem; color: var(--text-secondary); }
            
            .empty-state { text-align: center; padding: 3rem; color: var(--text-secondary); }
        </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>üõ°Ô∏è Vulcan Report</h1>
                <div class="meta">Agentic Security Scan Results</div>
            </div>
            <div class="meta">
                Generated: 2025-12-10 06:05:08
            </div>
        </header>

        <section class="stat-grid">
            <div class="card stat-card">
                <h3>Total Issues</h3>
                <p style="color: var(--text-primary)">4</p>
            </div>
            <div class="card stat-card">
                <h3>High Severity</h3>
                <p style="color: var(--danger)">4</p>
            </div>
            <div class="card stat-card">
                <h3>Fixed</h3>
                <p style="color: var(--success)">4</p>
            </div>
        </section>

        <section class="card">
            <h2>üîé Executive Summary</h2>
            <p class="summary-text">The new Cart implementation introduces several business logic flaws that can be exploited to manipulate pricing and payment flows. While no traditional injection or memory‚Äësafety risks are present, multiple high‚Äëimpact logic vulnerabilities allow attackers to create negative totals, stack discounts, or trigger exponential price reductions.</p>
        </section>

        <section>
            <h2>üö© Vulnerabilities</h2>
        
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Flaw - Negative Quantity</span>
                    <div>
                        <span class="badge badge-HIGH">HIGH</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:13</code>
                </div>
                <p>The add_item method allows negative quantities to be added to items, enabling attackers to reduce the cart total or potentially receive money back. This directly manipulates pricing logic and can cause significant financial loss.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Reject negative quantities by validating that quantity is a positive integer before updating the cart.</p>
                </div>
            </div>
                
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Flaw - Coupon Stacking</span>
                    <div>
                        <span class="badge badge-HIGH">HIGH</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:24</code>
                </div>
                <p>Coupons can be applied an unlimited number of times without checks to prevent reuse. Attackers can repeatedly apply the same coupon to drastically reduce the cart total.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Track applied coupons and prevent duplicate usage or enforce coupon usage limits.</p>
                </div>
            </div>
                
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Flaw - Repeated Percent-Based Discounts</span>
                    <div>
                        <span class="badge badge-HIGH">HIGH</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:29</code>
                </div>
                <p>Percentage-based discounts are applied directly to the current total without restrictions, allowing attackers to repeatedly apply the discount and exponentially reduce the price to near zero.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Ensure percentage discounts are applied only once or calculate them based on the original subtotal instead of iteratively modifying the total.</p>
                </div>
            </div>
                
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Flaw - Negative Total Allowed</span>
                    <div>
                        <span class="badge badge-HIGH">HIGH</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:39</code>
                </div>
                <p>The calculate_total method allows the cart total to become negative if discounts exceed the subtotal, potentially enabling users to receive a credit instead of paying.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Clamp the total at zero or enforce that discounts cannot exceed the subtotal.</p>
                </div>
            </div>
                
        </section>
    </div>
</body>
</html>
        