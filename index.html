
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vulcan Security Report</title>
    <style>
            :root {
                --bg-primary: #0f172a;
                --bg-secondary: #1e293b;
                --text-primary: #f8fafc;
                --text-secondary: #94a3b8;
                --accent: #38bdf8;
                --danger: #ef4444;
                --warning: #f59e0b;
                --success: #22c55e;
                --border: #334155;
            }
            body {
                font-family: 'Inter', system-ui, -apple-system, sans-serif;
                background-color: var(--bg-primary);
                color: var(--text-primary);
                line-height: 1.6;
                margin: 0;
                padding: 0;
            }
            .container {
                max-width: 1000px;
                margin: 0 auto;
                padding: 2rem;
            }
            header {
                border-bottom: 1px solid var(--border);
                padding-bottom: 2rem;
                margin-bottom: 2rem;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            h1 { font-size: 2rem; font-weight: 700; margin: 0; color: var(--accent); }
            h2 { font-size: 1.5rem; margin-top: 2rem; margin-bottom: 1rem; }
            .meta { color: var(--text-secondary); font-size: 0.9rem; }
            
            .card {
                background-color: var(--bg-secondary);
                border: 1px solid var(--border);
                border-radius: 0.75rem;
                padding: 1.5rem;
                margin-bottom: 1.5rem;
                box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            }
            .stat-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 1rem;
                margin-bottom: 2rem;
            }
            .stat-card h3 { margin: 0; font-size: 0.9rem; color: var(--text-secondary); text-transform: uppercase; letter-spacing: 0.05em; }
            .stat-card p { margin: 0.5rem 0 0; font-size: 2rem; font-weight: 700; }
            
            .vuln-header {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                margin-bottom: 1rem;
            }
            .vuln-title { font-weight: 600; font-size: 1.1rem; }
            .badge {
                padding: 0.25rem 0.75rem;
                border-radius: 9999px;
                font-size: 0.75rem;
                font-weight: 600;
                text-transform: uppercase;
            }
            .badge-HIGH { background-color: rgba(239, 68, 68, 0.2); color: var(--danger); }
            .badge-MEDIUM { background-color: rgba(245, 158, 11, 0.2); color: var(--warning); }
            .badge-FIXED { background-color: rgba(34, 197, 94, 0.2); color: var(--success); }
            .badge-OPEN { background-color: rgba(148, 163, 184, 0.2); color: var(--text-secondary); }
            
            code {
                background-color: rgba(0,0,0,0.3);
                padding: 0.2rem 0.4rem;
                border-radius: 0.25rem;
                font-family: monospace;
                font-size: 0.9em;
            }
            .summary-text { font-size: 1.1rem; color: var(--text-secondary); }
            
            .empty-state { text-align: center; padding: 3rem; color: var(--text-secondary); }
        </style>
</head>
<body>
    <div class="container">
        <header>
            <div>
                <h1>üõ°Ô∏è Vulcan Report</h1>
                <div class="meta">Agentic Security Scan Results</div>
            </div>
            <div class="meta">
                Generated: 2025-12-10 07:16:05
            </div>
        </header>

        <section class="stat-grid">
            <div class="card stat-card">
                <h3>Total Issues</h3>
                <p style="color: var(--text-primary)">2</p>
            </div>
            <div class="card stat-card">
                <h3>High Severity</h3>
                <p style="color: var(--danger)">0</p>
            </div>
            <div class="card stat-card">
                <h3>Fixed</h3>
                <p style="color: var(--success)">2</p>
            </div>
        </section>

        <section class="card">
            <h2>üîé Executive Summary</h2>
            <p class="summary-text">The new test scenario reveals business‚Äëlogic weaknesses in the discount and coupon system. The implementation allows unlimited stacking of fixed‚Äëvalue discounts and contains flawed ordering in percentage‚Äëbased discount calculation. These issues could enable malicious users to manipulate cart totals and obtain unauthorized discounts.</p>
        </section>

        <section>
            <h2>üö© Vulnerabilities</h2>
        
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Vulnerability</span>
                    <div>
                        <span class="badge badge-MEDIUM">MEDIUM</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:22</code>
                </div>
                <p>Fixed-value discounts are appended to the `discounts` list without any limit or validation, allowing repeated application of the same coupon (e.g., SAVE10) to drive the total cost toward zero. This creates a discount‚Äëabuse vulnerability.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Implement validation to ensure coupons can only be used once and verify coupon eligibility before applying the discount.</p>
                </div>
            </div>
                
            <div class="card">
                <div class="vuln-header">
                    <span class="vuln-title">Business Logic Vulnerability</span>
                    <div>
                        <span class="badge badge-MEDIUM">MEDIUM</span>
                        <span class="badge badge-FIXED">FIXED</span>
                    </div>
                </div>
                <div style="margin-bottom: 0.5rem;">
                    <strong>File:</strong> <code>tests/scenarios/logic_flaw_discount.py:24</code>
                </div>
                <p>The percentage discount (`PERCENT20`) modifies `self.total` before calling `calculate_total()`, but calculate_total recomputes subtotal and overrides the percentage adjustment. This inconsistent ordering can result in unexpected or bypassable discount behavior.</p>
                <div style="margin-top: 1rem; border-top: 1px solid var(--border); padding-top: 1rem;">
                    <strong>Suggested Fix:</strong>
                    <p style="color: var(--text-secondary);">Refactor coupon application to ensure percentage and fixed discounts are applied consistently within `calculate_total()`, and avoid modifying `self.total` prior to recalculation.</p>
                </div>
            </div>
                
        </section>
    </div>
</body>
</html>
        